import{s as y,o as d,c,a as n,h as f,u as r,a3 as L,g as I,t as _,F as k,x as C,E as M,b as Q,y as x,am as Y,n as $,an as G,ao as A,e as j,ap as J,w as g,p as F,aq as q,q as U,d as N,K,ar as O,as as P,at as h,T as W,au as H,av as X,aw as Z,ax as ee}from"./vendor-3-6-0.js";import{u as v}from"./CheckoutStore-3-6-0.js";import{_ as te}from"./_plugin-vue_export-helper-3-6-0.js";import{u as ae}from"./ajax-3-6-0.js";import{p as B}from"./store-3-6-0.js";const ne={class:"bg-yellow-100 text-yellow-700 p-3 flex flex-col rounded gap-2"},se={class:"flex items-center justify-between text-lg font-semibold"},oe={class:"flex items-center gap-2"},le=["src"],re={key:0},ie=n("th",null,null,-1),de={class:"hidden md:table-cell"},ce=n("th",{class:"hidden md:table-cell"}," Cvc ",-1),ue=n("th",{class:"hidden md:table-cell"}," 3ds ",-1),pe=n("th",null,null,-1),_e=["src"],me={class:"hidden md:table-cell"},ve={class:"hidden md:table-cell"},ye={class:"hidden md:table-cell"},rt={__name:"TestMode",setup(i){const{card:e,gateway:s,assetsUrl:t}=y(v()),o=l=>{e.value.bin=l.bin,e.value.expiry_year=l.expiry_year,e.value.expiry_month=l.expiry_month,e.value.expiry=`${l.expiry_month} / ${l.expiry_year}`,e.value.cvv=l.cvv};return(l,a)=>(d(),c("div",ne,[n("div",se,[n("div",oe,[f(r(L),{class:"w-6"}),I(_(l.$t("test_mode_title")),1)]),n("img",{src:r(s).logo,class:"w-[80px] max-h-[40px]"},null,8,le)]),n("div",null,_(l.$t("test_mode_checkout_desc")),1),r(s).test_cards.length>0?(d(),c("table",re,[n("tr",null,[ie,n("th",null,_(l.$t("card_bin")),1),n("th",de,_(l.$t("month_year")),1),ce,ue,pe]),n("tbody",null,[(d(!0),c(k,null,C(r(s).test_cards,(u,m)=>(d(),c("tr",{key:m,class:"!border-b !border-yellow-700"},[n("td",null,[n("img",{class:"!w-8",src:`${r(t)}/images/card/${u.brand}.svg`},null,8,_e)]),n("td",null,_(u.bin),1),n("td",me,_(u.expiry_month)+"/"+_(u.expiry_year),1),n("td",ve,_(u.cvv),1),n("td",ye,_(u.secure),1),n("td",null,[f(r(M),{class:"!w-6 cursor-pointer",onClick:tt=>o(u)},null,8,["onClick"])])]))),128))])])):Q("",!0)]))}},fe={class:"inline-flex relative !rounded-l items-center justify-start text-sm !bg-white !w-12 !min-w-max"},he=["placeholder"],it={__name:"HolderName",setup(i){const e=x(!1);return(s,t)=>(d(),c("div",{class:$(`flex w-full border !rounded ${e.value?"border-blue-700":"border-gray-300"}`)},[n("span",fe,[f(r(Y),{class:"w-6 h-6 mx-3","aria-hidden":"true"})]),n("input",{id:"gpos-card-holder-name",type:"text",placeholder:s.$t("name_on_card"),onFocus:t[0]||(t[0]=o=>e.value=!e.value),onFocusout:t[1]||(t[1]=o=>e.value=!e.value)},null,40,he)],2))}},ge={},xe={class:"dot-spinner mx-3"},be=G('<div class="dot-spinner__dot"></div><div class="dot-spinner__dot"></div><div class="dot-spinner__dot"></div><div class="dot-spinner__dot"></div><div class="dot-spinner__dot"></div><div class="dot-spinner__dot"></div><div class="dot-spinner__dot"></div><div class="dot-spinner__dot"></div>',8),$e=[be];function we(i,e){return d(),c("div",xe,$e)}const ke=te(ge,[["render",we]]),Ce={class:"inline-flex relative !rounded-l items-center justify-start text-sm !bg-white !w-12 !min-w-max"},Fe=["src"],dt={__name:"BinNumber",setup(i){const{card:e,assetsUrl:s}=y(v()),{loading:t}=y(ae()),o=x(!1);return(l,a)=>{const u=A("cardformat");return d(),c("div",{class:$(`flex w-full !border !rounded ${o.value?"!border-blue-700":"!border-gray-300"}`)},[n("span",Ce,[r(t)?(d(),j(ke,{key:0,class:"!w-6 !h-6"})):["visa","mastercard","amex"].includes(r(e).brand)?(d(),c("img",{key:1,class:"!w-12 !h-12 !m-0",src:`${r(s)}/images/card/${r(e).brand}.svg`},null,8,Fe)):(d(),j(r(J),{key:2,class:"!w-6 h-6 !mx-3","aria-hidden":"true"}))]),g(n("input",{id:"gpos-card-bin","onUpdate:modelValue":a[0]||(a[0]=m=>r(e).bin=m),class:"",placeholder:"•••• •••• •••• ••••",inputmode:"numeric",type:"tel",autocomplete:"cc-number",onFocus:a[1]||(a[1]=m=>o.value=!o.value),onFocusout:a[2]||(a[2]=m=>o.value=!o.value)},null,544),[[F,r(e).bin],[u,void 0,"formatCardNumber"]])],2)}}},Ve={class:"inline-flex relative !rounded-l items-center justify-center text-sm !bg-white !w-12 !min-w-max"},Ee={class:"flex w-full"},je={value:""},Ae=["value","textContent"],Be={value:""},Se=["value","textContent"],Ue={__name:"Select",setup(i){const e=v(),{card:s}=y(e),t=x(!1);return(o,l)=>(d(),c("div",{class:$(`flex w-full !border !rounded ${t.value?"!border-blue-700":"!border-gray-300"}`)},[n("span",Ve,[f(r(q),{class:"!w-6 !h-6 !mx-3","aria-hidden":"true"})]),n("div",Ee,[g(n("select",{id:"gpos-card-expiry-month","onUpdate:modelValue":l[0]||(l[0]=a=>r(s).expiry_month=a),autocomplete:"cc-exp-month",class:"!border-0 !rounded-r !bg-white !m-0 !p-3 !focus:ring-0 !outline-0 !focus:ring-offset-0 !w-1/2",onFocus:l[1]||(l[1]=a=>t.value=!t.value),onFocusout:l[2]||(l[2]=a=>t.value=!t.value)},[n("option",je,_(o.$t("mm")),1),(d(),c(k,null,C(["01","02","03","04","05","06","07","08","09","10","11","12"],a=>n("option",{key:a,value:a,textContent:_(a)},null,8,Ae)),64))],544),[[U,r(s).expiry_month]]),g(n("select",{id:"gpos-card-expiry-year","onUpdate:modelValue":l[3]||(l[3]=a=>r(s).expiry_year=a),autocomplete:"cc-exp-year",class:"!border-0 !rounded-r !bg-white !m-0 !p-3 !focus:ring-0 !outline-0 !focus:ring-offset-0 !w-1/2",onFocus:l[4]||(l[4]=a=>t.value=!t.value),onFocusout:l[5]||(l[5]=a=>t.value=!t.value)},[n("option",Be,_(o.$t("yy")),1),(d(),c(k,null,C(["2023","2024","2025","2026","2027","2028","2029","2030","2031","2032","2033"],a=>n("option",{key:a,value:a,textContent:_(a)},null,8,Se)),64))],544),[[U,r(s).expiry_year]])])],2))}},Ne={class:"inline-flex relative !rounded-l items-center justify-center text-sm !bg-white !w-12 !min-w-max"},Te=["placeholder"],De=["value"],Ie=["value"],qe={__name:"Text",setup(i){const{card:e}=y(v()),s=x(!1),t=N(()=>{var l,a;return(a=(l=e.value.expiry)==null?void 0:l.replaceAll(/\s/g,""))==null?void 0:a.split("/")[0]}),o=N(()=>{var l,a,u;return(u=(a=(l=e.value.expiry)==null?void 0:l.replaceAll(/\s/g,""))==null?void 0:a.split("/")[1])==null?void 0:u.slice(-2)});return(l,a)=>{const u=A("cardformat");return d(),c("div",{class:$(`flex w-full !border !rounded ${s.value?"!border-blue-700":"!border-gray-300"}`)},[n("span",Ne,[f(r(q),{class:"!w-6 !h-6","aria-hidden":"true"})]),g(n("input",{id:"gpos-card-expiry","onUpdate:modelValue":a[0]||(a[0]=m=>r(e).expiry=m),placeholder:l.$t("mmyy"),inputmode:"numeric",type:"tel",autocomplete:"cc-exp",onFocus:a[1]||(a[1]=m=>s.value=!s.value),onFocusout:a[2]||(a[2]=m=>s.value=!s.value)},null,40,Te),[[F,r(e).expiry],[u,void 0,"formatCardExpiry"]]),n("input",{id:"gpos-card-expiry-month",type:"hidden",value:t.value},null,8,De),n("input",{id:"gpos-card-expiry-year",type:"hidden",value:o.value},null,8,Ie)],2)}}},ct={__name:"Expiry",setup(i){const{formSettings:e}=v(),s=e.expiry_style=="select"?Ue:qe;return(t,o)=>(d(),j(K(r(s))))}},He={class:"inline-flex relative !rounded-l !items-center justify-center text-sm !bg-white !w-12 !min-w-max"},Re=n("div",{class:"!w-6 !h-6 absolute","aria-hidden":"true",style:{"backface-visibility":"hidden"}},null,-1),ze=["src"],ut={__name:"Cvc",setup(i){const e=v(),{card:s,assetsUrl:t}=y(e),o=x(!1);return(l,a)=>{const u=A("cardformat");return d(),c("div",{class:$(`relative flex w-full !border !bg-white !rounded ${o.value?"!border-blue-700":"!border-gray-300"}`)},[n("span",He,[f(r(O),{class:"!w-6 !h-6 !mx-3","aria-hidden":"true"})]),g(n("input",{id:"gpos-card-cvv","onUpdate:modelValue":a[0]||(a[0]=m=>r(s).cvv=m),placeholder:"CVC",inputmode:"numeric",type:"tel",autocomplete:"cc-csc",onFocus:a[1]||(a[1]=m=>o.value=!o.value),onFocusout:a[2]||(a[2]=m=>o.value=!o.value)},null,544),[[F,r(s).cvv],[u,void 0,"formatCardCVC"]]),n("span",{class:"inline-flex relative !rounded z-10 items-center justify-center text-sm !bg-white !w-12 !min-w-max !px-2",style:P(`${o.value?"transform: rotateY(180deg);":""}   transform-style: preserve-3d;
        transition: transform 0.5s;`)},[Re,n("img",{class:"!w-8 !h-6 absolute",src:`${r(t)}/images/cvc.svg`,style:{"backface-visibility":"hidden",transform:"rotateY(180deg)"}},null,8,ze)],4)],2)}}},Le={class:"hidden"},Me=["id","onUpdate:modelValue"],pt={__name:"HiddenCardData",setup(i){const{card:e}=y(v());return(s,t)=>(d(),c("div",Le,[(d(),c(k,null,C(["type","brand","family","bank_name","bank_code","country","country_code"],o=>g(n("input",{id:`gpos-card-${o.replaceAll("_","-")}`,key:o,"onUpdate:modelValue":l=>r(e)[o]=l,type:"hidden"},null,8,Me),[[F,r(e)[o]]])),64))]))}},Qe=i=>{const e=document.getElementById("_gpos_nonce").value,s=h.random.getBytesSync(16),t=h.cipher.createCipher("AES-CBC",h.util.hexToBytes(h.md.sha256.create().update(e).digest().toHex()));return t.start({iv:s}),t.update(h.util.createBuffer(i,"utf8")),t.finish(),{hex:t.output.toHex(),iv:h.util.bytesToHex(s)}},Ye=["value"],Ge=["value"],_t={__name:"Fragments",setup(i){const e=x("");return document.addEventListener("gpos-inputs-changed",async s=>{e.value=Qe(JSON.stringify(s.detail)),window.gpos.fragment={_wp_refreshed_fragments:e.value.hex,_wp_fragment:e.value.iv}}),(s,t)=>(d(),c("div",null,[n("input",{type:"hidden",name:"_wp_refreshed_fragments",value:e.value.hex},null,8,Ye),n("input",{type:"hidden",name:"_wp_fragment",value:e.value.iv},null,8,Ge)]))}},Je={class:"w-full bg-red-200 text-red-700 p-3 rounded font-semibold flex gap-2"},mt={__name:"GatewayError",setup(i){return(e,s)=>(d(),c("div",Je,[f(r(W),{class:"w-10"}),I(" "+_(e.$t("gateway_error")),1)]))}},V=()=>{const i=window.jQuery;let e={};i(".gpos-checkout-class :input").each((s,t)=>{let o=i(t);if(!(o.attr("type")==="checkbox"&&!o.is(":checked"))){if(o.data("name")==="gpos-installment"){o.is(":checked")&&(e[o.data("name")]=o.val(),e["gpos-installment-rate"]=o.data("rate"));return}o.attr("id")&&(e[o.attr("id")]=o.val())}}),document.dispatchEvent(new CustomEvent("gpos-inputs-changed",{detail:e}))};let b=!1;const S=window.jQuery,w=()=>{b&&b.unmount(),b=window.gposCreateCheckoutApplication()};S(document).ready(w);S(document.body).on("updated_checkout",w);S(document).on("give_gateway_loaded",w);jQuery("input[name='radio-control-wc-payment-method-options']").on("change",function(i){i.target.value==="gpos"&&w()});setInterval(()=>{(typeof b!="object"||!b.mount)&&w()},1e3);const{card:p,requestedBin:E,requestedInstallment:T,binRetrieveReq:D,gateway:Ke,isInstallmentsActive:Oe,installments:Pe,plugin:We,isProActive:R,platformData:Xe,selectedInstallment:z}=y(v(B)),{binRetrieve:Ze,$:et}=v(B);document.addEventListener("gpos-inputs-changed",async()=>{var s;const i=(s=p.value.bin)==null?void 0:s.replace(/\D/g,"").slice(0,8),e=z.value;if(!i||i.length<8){E.value="",p.value.type="",p.value.brand="",p.value.family="",p.value.bank_name="",p.value.bank_code="",p.value.country="",p.value.country_code="";return}(E.value!==i||T.value!==e)&&(E.value=i,T.value=e,D.value&&D.value.abort(),await Ze({bin:i,plugin:We.value,total:Xe.value.amount,installment:e}).then(t=>{R.value&&(Ke.value=t==null?void 0:t.gateway,Pe.value=t==null?void 0:t.installments,Oe.value=t==null?void 0:t.is_installments_active),p.value.type=t.card.type,p.value.brand=t.card.brand,p.value.family=t.card.family,p.value.bank_name=t.bank.name,p.value.bank_code=t.bank.code,p.value.country_code=t.country.code,p.value.country=t.country.name}),V())});H(p,V,{deep:!0});R.value&&H(z,V,{deep:!0});et(document).on({input:V},".gpos-checkout-class :input");function vt(i){window.gposCreateCheckoutApplication=()=>{const e=X({locale:"default",messages:window.gpos.strings,legacy:!1}),s=Z(i);return s.use(ee),s.use(B),s.use(e),s.mount("#app"),document.dispatchEvent(new CustomEvent("gpos-form-loaded",{detail:window.gpos})),s}}export{dt as _,ct as a,ut as b,pt as c,rt as d,it as e,_t as f,mt as g,vt as h,V as i};
